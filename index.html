<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shablon Tanlash</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            padding: 16px;
            padding-bottom: 80px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.6;
        }
        
        .categories {
            display: grid;
            gap: 12px;
        }
        
        .category-card {
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .category-card:active {
            transform: scale(0.98);
        }
        
        .category-card.selected {
            border-color: var(--tg-theme-button-color, #0088cc);
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        
        .category-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        
        .category-icon {
            font-size: 28px;
        }
        
        .category-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .category-desc {
            font-size: 13px;
            opacity: 0.7;
            margin-top: 4px;
        }
        
        .category-count {
            font-size: 12px;
            opacity: 0.6;
            margin-top: 8px;
        }
        
        .templates-section {
            margin-top: 24px;
            display: none;
        }
        
        .templates-section.visible {
            display: block;
        }
        
        .templates-header {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .template-card {
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 12px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            position: relative;
        }
        
        .template-card:active {
            transform: scale(0.95);
        }
        
        .template-card.selected {
            border-color: var(--tg-theme-button-color, #0088cc);
        }
        
        .template-colors {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
            height: 24px;
        }
        
        .color-dot {
            flex: 1;
            border-radius: 4px;
        }
        
        .template-name {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 4px;
            line-height: 1.3;
        }
        
        .template-slides {
            font-size: 11px;
            opacity: 0.6;
        }
        
        .back-button {
            margin-top: 16px;
            padding: 12px;
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
        }
        
        .selected-info {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--tg-theme-bg-color, #ffffff);
            border-top: 1px solid rgba(0,0,0,0.1);
            padding: 16px;
            display: none;
        }
        
        .selected-info.visible {
            display: block;
        }
        
        .selected-text {
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .selected-template {
            font-weight: 600;
            color: var(--tg-theme-button-color, #0088cc);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé® Shablon tanlash</h1>
        <p>Yo'nalishni tanlang</p>
    </div>
    
    <div id="categoriesView" class="categories">
        <!-- Categories will be inserted here -->
    </div>
    
    <div id="templatesView" class="templates-section">
        <div class="templates-header">Shablonlar</div>
        <div id="templatesGrid" class="templates-grid">
            <!-- Templates will be inserted here -->
        </div>
        <div class="back-button" onclick="backToCategories()">‚¨ÖÔ∏è Orqaga</div>
    </div>
    
    <div id="selectedInfo" class="selected-info">
        <div class="selected-text">Tanlandi: <span class="selected-template" id="selectedName"></span></div>
    </div>
    
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText("Davom etish");
        
        const TEMPLATES = {
            "1_biznes_moliya": {
                "name_uz": "üíº Biznes va Moliya",
                "description_uz": "Kompaniya, marketing, iqtisodiyot",
                "templates": [
                    {"id": 1, "name_en": "Accounting Services", "slides": 20, "colors": ["#080C3A","#2A458A","#95D837"]},
                    {"id": 2, "name_en": "Cryptocurrency", "slides": 30, "colors": ["#F1E8DC","#FBBF60","#39B0D1"]},
                    {"id": 3, "name_en": "Dark Academia", "slides": 35, "colors": ["#E2C578","#B08E65","#1A0803"]},
                    {"id": 4, "name_en": "Digital Banking", "slides": 50, "colors": ["#263238","#FF8E00","#FFCA86"]},
                    {"id": 5, "name_en": "Economic Activity", "slides": 19, "colors": ["#243B50","#EFEEEA","#D9E7D8"]},
                    {"id": 6, "name_en": "Falling Money", "slides": 14, "colors": ["#363D23","#424B2B","#6C7B46"]},
                    {"id": 7, "name_en": "Financial Education", "slides": 36, "colors": ["#241834","#FFF7E7","#F5C05A"]},
                    {"id": 8, "name_en": "Financial Markets", "slides": 50, "colors": ["#162E4C","#476B9E","#5982B2"]},
                    {"id": 9, "name_en": "Gap Analysis", "slides": 36, "colors": ["#212529","#C92727","#AC1C1E"]},
                    {"id": 10, "name_en": "History Capitalism", "slides": 35, "colors": ["#158158","#F3F3F3","#058DC7"]},
                ]
            },
            "2_talim_pedagogika": {
                "name_uz": "üéì Ta'lim va Pedagogika",
                "description_uz": "Maktab, universitet, dars",
                "templates": [
                    {"id": 1, "name_en": "Back to School", "slides": 13, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Digital Resources", "slides": 56, "colors": ["#674EA7","#E9FCE3","#351C75"]},
                    {"id": 3, "name_en": "Educational Workshop", "slides": 31, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 4, "name_en": "Generation of 27", "slides": 60, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 5, "name_en": "Aesthetic Notes", "slides": 35, "colors": ["#ECECEC","#FFDBDE","#AEC6CF"]},
                    {"id": 6, "name_en": "School Subjects", "slides": 20, "colors": ["#323B5C","#D9F0F6","#E8EDEE"]},
                    {"id": 7, "name_en": "Sketchnotes", "slides": 20, "colors": ["#595959","#EEEEEE","#FEB8B3"]},
                    {"id": 8, "name_en": "STEM Education", "slides": 59, "colors": ["#060607","#2E3B46","#465557"]},
                    {"id": 9, "name_en": "Flipped Classroom", "slides": 55, "colors": ["#595959","#EEEEEE","#FFAB40"]},
                    {"id": 10, "name_en": "Education Day", "slides": 41, "colors": ["#158158","#F3F3F3","#058DC7"]},
                ]
            },
            "3_texnologiya_it": {
                "name_uz": "üíª Texnologiya va IT",
                "description_uz": "Dasturlash, AI, innovatsiya",
                "templates": [
                    {"id": 1, "name_en": "AI Tech Agency", "slides": 46, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Data Center", "slides": 58, "colors": ["#606060","#151B46","#2C4ED7"]},
                    {"id": 3, "name_en": "Online News App", "slides": 52, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 4, "name_en": "Software Development", "slides": 36, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 5, "name_en": "Software Testing", "slides": 33, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 6, "name_en": "STEM Cybersecurity", "slides": 34, "colors": ["#150045","#A4ABD7","#E23480"]},
                    {"id": 7, "name_en": "Tech Consulting", "slides": 28, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 8, "name_en": "Tech Startup", "slides": 58, "colors": ["#595959","#EEEEEE","#88D3CE"]},
                    {"id": 9, "name_en": "Technology Thesis", "slides": 23, "colors": ["#133B96","#595959","#EEEEEE"]},
                    {"id": 10, "name_en": "Virtual Metaverse", "slides": 28, "colors": ["#0D092A","#3333B8","#35CFDB"]},
                    {"id": 11, "name_en": "Web Project", "slides": 19, "colors": ["#158158","#F3F3F3","#058DC7"]},
                ]
            },
            "4_tibbiyot_soglik": {
                "name_uz": "üè• Tibbiyot va Sog'liq",
                "description_uz": "Tibbiyot, farmatsevtika",
                "templates": [
                    {"id": 1, "name_en": "Cardiovascular", "slides": 25, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Clinical Case", "slides": 31, "colors": ["#4AA276","#595959","#EEEEEE"]},
                    {"id": 3, "name_en": "Coronary Heart", "slides": 25, "colors": ["#180000","#690100","#AD0101"]},
                    {"id": 4, "name_en": "Healthcare Center", "slides": 52, "colors": ["#191919","#FFFCF2","#F0E9DD"]},
                    {"id": 5, "name_en": "Cystic Fibrosis", "slides": 26, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 6, "name_en": "Healthcare Info", "slides": 11, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 7, "name_en": "Listeriosis", "slides": 23, "colors": ["#DDFF70","#019758","#0097A7"]},
                    {"id": 8, "name_en": "Mental Health", "slides": 31, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 9, "name_en": "Mental Tips", "slides": 18, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 10, "name_en": "Hepatitis C", "slides": 24, "colors": ["#330404","#FFD300","#FFAA00"]},
                ]
            },
            "5_adabiyot_tilshunoslik": {
                "name_uz": "üìö Adabiyot va Tilshunoslik",
                "description_uz": "Adabiyot, til, she'riyat",
                "templates": [
                    {"id": 1, "name_en": "Classical Literature", "slides": 30, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Grimm Brothers", "slides": 18, "colors": ["#2E303B","#E9F4C8","#407273"]},
                    {"id": 3, "name_en": "German Literature", "slides": 52, "colors": ["#5D412D","#B68B6D","#EDB6A8"]},
                    {"id": 4, "name_en": "Gothic Literature", "slides": 28, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 5, "name_en": "African Poetry", "slides": 28, "colors": ["#514232","#DBBF8A","#87754F"]},
                    {"id": 6, "name_en": "Dark Romanticism", "slides": 31, "colors": ["#191919","#595959","#0097A7"]},
                    {"id": 7, "name_en": "Literary Analysis", "slides": 23, "colors": ["#3A3A3A","#E6E2D2","#96A397"]},
                    {"id": 8, "name_en": "Existentialism", "slides": 26, "colors": ["#191919","#F5F3EE","#0097A7"]},
                    {"id": 9, "name_en": "Pride and Prejudice", "slides": 28, "colors": ["#411908","#F2EADF","#D9C2A7"]},
                    {"id": 10, "name_en": "Epic Poetry", "slides": 24, "colors": ["#373145","#EDE9D7","#F2E6D3"]},
                ]
            },
            "6_ijtimoiy_fanlar": {
                "name_uz": "üë• Ijtimoiy fanlar",
                "description_uz": "Sotsiologiya, psixologiya",
                "templates": [
                    {"id": 1, "name_en": "Diversity", "slides": 29, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Sociology", "slides": 33, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 3, "name_en": "OCD Treatment", "slides": 25, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 4, "name_en": "Psychology", "slides": 20, "colors": ["#191919","#5D82A7","#D84C50"]},
                    {"id": 5, "name_en": "Psychopathology", "slides": 18, "colors": ["#2A2C4F","#5A6DFF","#9AA5FF"]},
                    {"id": 6, "name_en": "Racial Tolerance", "slides": 18, "colors": ["#572A26","#D0574F","#F5E9E2"]},
                    {"id": 7, "name_en": "Public Health", "slides": 19, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 8, "name_en": "Social Inclusion", "slides": 26, "colors": ["#263238","#455A64","#EBEBEB"]},
                    {"id": 9, "name_en": "Globalization", "slides": 30, "colors": ["#061D28","#B9E6ED","#16C5D5"]},
                    {"id": 10, "name_en": "Sociology Research", "slides": 23, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 11, "name_en": "Youth Mental", "slides": 26, "colors": ["#332C27","#E8B0AF","#F9F6F1"]},
                ]
            },
            "7_fan_tadqiqot": {
                "name_uz": "üî¨ Fan va Tadqiqot",
                "description_uz": "Fizika, kimyo, biologiya",
                "templates": [
                    {"id": 1, "name_en": "Biochemistry", "slides": 31, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Properties Matter", "slides": 18, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 3, "name_en": "Epidemiology", "slides": 30, "colors": ["#345CAC","#F4F2E6","#B2D6E6"]},
                    {"id": 4, "name_en": "Outdoor Science", "slides": 31, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 5, "name_en": "Physical Sciences", "slides": 29, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 6, "name_en": "Newton's Laws", "slides": 30, "colors": ["#1F2823","#75B978","#CCD7C4"]},
                    {"id": 7, "name_en": "Science Education", "slides": 21, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 8, "name_en": "Science Inquiry", "slides": 31, "colors": ["#E9EAF9","#FDE264","#9DB3F0"]},
                    {"id": 9, "name_en": "Science Tools", "slides": 28, "colors": ["#158158","#F3F3F3","#058DC7"]},
                ]
            },
            "8_tarix_madaniyat": {
                "name_uz": "üìú Tarix va Madaniyat",
                "description_uz": "Tarix, arxeologiya, san'at",
                "templates": [
                    {"id": 1, "name_en": "Napoleon", "slides": 29, "colors": ["#422100","#FFF0D5","#CC9A67"]},
                    {"id": 2, "name_en": "Abraham Lincoln", "slides": 22, "colors": ["#242424","#0097A7"]},
                    {"id": 3, "name_en": "French Revolution", "slides": 16, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 4, "name_en": "Industrial Rev", "slides": 13, "colors": ["#443629","#DBE4E9","#634331"]},
                    {"id": 5, "name_en": "Industrial 9th", "slides": 28, "colors": ["#3E382A","#E6DFD4","#942B27"]},
                    {"id": 6, "name_en": "Islamic History", "slides": 12, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 7, "name_en": "Roman Mythology", "slides": 26, "colors": ["#F1E8D8","#5B6356","#708648"]},
                    {"id": 8, "name_en": "Papyrus History", "slides": 35, "colors": ["#482400","#595959","#EEEEEE"]},
                    {"id": 9, "name_en": "Colonialism", "slides": 32, "colors": ["#553410","#C69C6D","#D0C4B4"]},
                    {"id": 10, "name_en": "Vintage History", "slides": 26, "colors": ["#492B16","#FFB055","#EEE9D9"]},
                ]
            },
            "9_tabiat_ekologiya": {
                "name_uz": "üåø Tabiat va Ekologiya",
                "description_uz": "Atrof-muhit, geografiya",
                "templates": [
                    {"id": 1, "name_en": "Sage Green", "slides": 19, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 2, "name_en": "Spring Woods", "slides": 19, "colors": ["#394644","#FFFDF9","#DBECCD"]},
                    {"id": 3, "name_en": "Natural Science", "slides": 23, "colors": ["#6C503E","#FCFCF7","#446652"]},
                    {"id": 4, "name_en": "Nature Aesthetic", "slides": 13, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 5, "name_en": "Environment", "slides": 18, "colors": ["#E7EED9","#B5DA92","#8BA864"]},
                    {"id": 6, "name_en": "Soil Pollution", "slides": 26, "colors": ["#212F40","#39474B","#5A676D"]},
                    {"id": 7, "name_en": "Fertilizer", "slides": 20, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 8, "name_en": "Environmental Ed", "slides": 29, "colors": ["#222221","#EFF1E8","#C6D576"]},
                    {"id": 9, "name_en": "Nature Style", "slides": 15, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 10, "name_en": "Trees Education", "slides": 26, "colors": ["#F0D162","#F8FFE1","#8A7165"]},
                ]
            },
            "10_kreativ_universal": {
                "name_uz": "üé® Kreativ va Universal",
                "description_uz": "Minimalist, portfolio, media",
                "templates": [
                    {"id": 3, "name_en": "Japan School", "slides": 11, "colors": ["#2A2A2A","#FEFFFF","#C55100"]},
                    {"id": 5, "name_en": "Notebook Lesson", "slides": 36, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 6, "name_en": "Creative Solutions", "slides": 24, "colors": ["#0000E0","#F4F4F9","#595959"]},
                    {"id": 7, "name_en": "Squiggles Design", "slides": 17, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 8, "name_en": "Creative Writing", "slides": 27, "colors": ["#2B2E5F","#F3F3F3","#0080CF"]},
                    {"id": 9, "name_en": "Plot Twist", "slides": 29, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 10, "name_en": "Business Canvas", "slides": 35, "colors": ["#213237","#F05F42","#87D2E4"]},
                    {"id": 11, "name_en": "Story Together", "slides": 14, "colors": ["#38355A","#C8E7BF","#EAF8C8"]},
                    {"id": 12, "name_en": "Watercolor", "slides": 14, "colors": ["#158158","#F3F3F3","#058DC7"]},
                    {"id": 13, "name_en": "Colorful Theme", "slides": 20, "colors": ["#2C2C2C","#FDFBFB","#F3474E"]},
                ]
            }
        };
        
        let selectedCategory = null;
        let selectedTemplate = null;
        
        // Render categories
        function renderCategories() {
            const container = document.getElementById('categoriesView');
            container.innerHTML = '';
            
            Object.keys(TEMPLATES).forEach(key => {
                const cat = TEMPLATES[key];
                const card = document.createElement('div');
                card.className = 'category-card';
                card.onclick = () => selectCategory(key);
                
                card.innerHTML = `
                    <div class="category-header">
                        <div class="category-title">${cat.name_uz}</div>
                    </div>
                    <div class="category-desc">${cat.description_uz}</div>
                    <div class="category-count">${cat.templates.length} ta shablon</div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Select category
        function selectCategory(key) {
            selectedCategory = key;
            renderTemplates(key);
            
            document.getElementById('categoriesView').style.display = 'none';
            document.getElementById('templatesView').classList.add('visible');
        }
        
        // Render templates
        function renderTemplates(categoryKey) {
            const container = document.getElementById('templatesGrid');
            container.innerHTML = '';
            
            const templates = TEMPLATES[categoryKey].templates;
            templates.forEach(tmpl => {
                const card = document.createElement('div');
                card.className = 'template-card';
                card.onclick = () => selectTemplate(categoryKey, tmpl);
                
                const colorsHtml = tmpl.colors.slice(0, 3).map(c => 
                    `<div class="color-dot" style="background: ${c}"></div>`
                ).join('');
                
                card.innerHTML = `
                    <div class="template-colors">${colorsHtml}</div>
                    <div class="template-name">${tmpl.name_en}</div>
                    <div class="template-slides">${tmpl.slides} slayd</div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Select template
        function selectTemplate(categoryKey, template) {
            selectedTemplate = {category: categoryKey, ...template};
            
            // Visual selection
            document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Show selected info
            document.getElementById('selectedName').textContent = template.name_en;
            document.getElementById('selectedInfo').classList.add('visible');
            
            // Enable main button
            tg.MainButton.show();
            tg.MainButton.onClick(() => {
                tg.sendData(JSON.stringify(selectedTemplate));
                tg.close();
            });
        }
        
        // Back to categories
        function backToCategories() {
            document.getElementById('categoriesView').style.display = 'grid';
            document.getElementById('templatesView').classList.remove('visible');
            document.getElementById('selectedInfo').classList.remove('visible');
            tg.MainButton.hide();
        }
        
        // Initialize
        renderCategories();
    </script>
</body>
</html>
